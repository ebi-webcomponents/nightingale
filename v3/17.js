(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1071:function(t,e){t.exports='<h1 id="protvista-structure">protvista-structure</h1>\n<p><a href="https://www.npmjs.com/package/protvista-structure"><img src="https://img.shields.io/npm/v/protvista-structure.svg" alt="Published on NPM"></a></p>\n<p>A native web component wrapper around Mol*</p>\n<h2 id="usage">Usage</h2>\n<pre><code class="language-html">&lt;!-- With UniProt Accession --&gt;\n&lt;protvista-structure accession=&quot;P06493&quot; structureId=&quot;4YC3&quot; /&gt;\n&lt;!-- With a specific PDBe entry selected and the entry table being hidden --&gt;\n&lt;protvista-structure\n  accession=&quot;P06493&quot;\n  highlight=&quot;209:220&quot;\n  structureId=&quot;4YC3&quot;\n  hide-table\n/&gt;</code></pre>\n<h2 id="api-reference">API Reference</h2>\n<h3 id="properties">Properties</h3>\n<h4 id="accession"><code>accession</code></h4>\n<p>A UniProt protein accession.</p>\n<h4 id="highlight"><code>highlight</code></h4>\n<p>This is a comma separated list of numerical ranges represented as a string e.g. &quot;1-5,10-20&quot;. When available, it will highlight all the residues corresponding to the given sequence positions.</p>\n<h4 id="structureid"><code>structureId</code></h4>\n<p>The id of the structure to display for the provided accession.</p>\n<h4 id="height"><code>height</code></h4>\n<p>The optional height of both table -- if visible, and the 3D structure. By default the value is set to <code>480px</code>. This should be a string value, representing a valid CSS value for an element&#39;s height property.</p>\n<h4 id="uniprot-mapping-url"><code>uniprot-mapping-url</code></h4>\n<p>Optional custom URL for fetching the mapping from PDB to UniProt. The lowercase PDB ID is appended here.</p>\n<h4 id="alphafold-mapping-url"><code>alphafold-mapping-url</code></h4>\n<p>Optional custom URL for fetching the AlphaFold prediction metadata and mapping. The AlphaFold structure ID is appended here.</p>\n<h4 id="custom-download-url"><code>custom-download-url</code></h4>\n<p>Optional custom URL for downloading cif structure files. The lowercase PDB ID is appended to it, including <code>.cif</code> suffix.</p>\n<h4 id="use-ctrl-to-zoom"><code>use-ctrl-to-zoom</code></h4>\n<p>Analogous to <code>protvista-zoomable</code>, use control key when scrolling to zoom the viewer</p>\n'},1072:function(t){t.exports=JSON.parse('[{"databaseType":"PDB","id":"1AAP","properties":{"Method":"X-ray","Resolution":"1.50 A","Chains":"A/B=287-344"}},{"databaseType":"PDB","id":"1AMB","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-699"}},{"databaseType":"PDB","id":"1AMC","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-699"}},{"databaseType":"PDB","id":"1AML","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-711"}},{"databaseType":"PDB","id":"1BA4","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-711"}},{"databaseType":"PDB","id":"1BA6","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-711"}},{"databaseType":"PDB","id":"1BJB","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-699"}},{"databaseType":"PDB","id":"1BJC","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-699"}},{"databaseType":"PDB","id":"1BRC","properties":{"Method":"X-ray","Resolution":"2.50 A","Chains":"I=287-342"}},{"databaseType":"PDB","id":"1CA0","properties":{"Method":"X-ray","Resolution":"2.10 A","Chains":"D/I=289-342"}},{"databaseType":"PDB","id":"1HZ3","properties":{"Method":"NMR","Resolution":"-","Chains":"A=681-706"}},{"databaseType":"PDB","id":"1IYT","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-713"}},{"databaseType":"PDB","id":"1MWP","properties":{"Method":"X-ray","Resolution":"1.80 A","Chains":"A=28-123"}},{"databaseType":"PDB","id":"1OWT","properties":{"Method":"NMR","Resolution":"-","Chains":"A=124-189"}},{"databaseType":"PDB","id":"1QCM","properties":{"Method":"NMR","Resolution":"-","Chains":"A=696-706"}},{"databaseType":"PDB","id":"1QWP","properties":{"Method":"NMR","Resolution":"-","Chains":"A=696-706"}},{"databaseType":"PDB","id":"1QXC","properties":{"Method":"NMR","Resolution":"-","Chains":"A=696-706"}},{"databaseType":"PDB","id":"1QYT","properties":{"Method":"NMR","Resolution":"-","Chains":"A=696-706"}},{"databaseType":"PDB","id":"1TAW","properties":{"Method":"X-ray","Resolution":"1.80 A","Chains":"B=287-344"}},{"databaseType":"PDB","id":"1TKN","properties":{"Method":"NMR","Resolution":"-","Chains":"A=460-569"}},{"databaseType":"PDB","id":"1UO7","properties":{"Method":"Model","Resolution":"-","Chains":"A=672-713"}},{"databaseType":"PDB","id":"1UO8","properties":{"Method":"Model","Resolution":"-","Chains":"A=672-713"}},{"databaseType":"PDB","id":"1UOA","properties":{"Method":"Model","Resolution":"-","Chains":"A=672-713"}},{"databaseType":"PDB","id":"1UOI","properties":{"Method":"Model","Resolution":"-","Chains":"A=672-713"}},{"databaseType":"PDB","id":"1X11","properties":{"Method":"X-ray","Resolution":"2.50 A","Chains":"C/D=754-766"}},{"databaseType":"PDB","id":"1Z0Q","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-713"}},{"databaseType":"PDB","id":"1ZE7","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-687"}},{"databaseType":"PDB","id":"1ZE9","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-687"}},{"databaseType":"PDB","id":"1ZJD","properties":{"Method":"X-ray","Resolution":"2.60 A","Chains":"B=289-344"}},{"databaseType":"PDB","id":"2BEG","properties":{"Method":"NMR","Resolution":"-","Chains":"A/B/C/D/E=672-713"}},{"databaseType":"PDB","id":"2BOM","properties":{"Method":"Model","Resolution":"-","Chains":"A/B=681-713"}},{"databaseType":"PDB","id":"2BP4","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-687"}},{"databaseType":"PDB","id":"2FJZ","properties":{"Method":"X-ray","Resolution":"1.61 A","Chains":"A=133-189"}},{"databaseType":"PDB","id":"2FK1","properties":{"Method":"X-ray","Resolution":"1.60 A","Chains":"A=133-189"}},{"databaseType":"PDB","id":"2FK2","properties":{"Method":"X-ray","Resolution":"1.65 A","Chains":"A=133-189"}},{"databaseType":"PDB","id":"2FK3","properties":{"Method":"X-ray","Resolution":"2.40 A","Chains":"A/B/C/D/E/F/G/H=133-189"}},{"databaseType":"PDB","id":"2FKL","properties":{"Method":"X-ray","Resolution":"2.50 A","Chains":"A/B=124-189"}},{"databaseType":"PDB","id":"2FMA","properties":{"Method":"X-ray","Resolution":"0.85 A","Chains":"A=133-189"}},{"databaseType":"PDB","id":"2G47","properties":{"Method":"X-ray","Resolution":"2.10 A","Chains":"C/D=672-711"}},{"databaseType":"PDB","id":"2IPU","properties":{"Method":"X-ray","Resolution":"1.65 A","Chains":"P/Q=672-679"}},{"databaseType":"PDB","id":"2LFM","properties":{"Method":"NMR","Resolution":"-","Chains":"A=672-711"}},{"databaseType":"PDB","id":"2LLM","properties":{"Method":"NMR","Resolution":"-","Chains":"A=686-726"}},{"databaseType":"PDB","id":"2LMN","properties":{"Method":"NMR","Resolution":"-","Chains":"A/B/C/D/E/F/G/H/I/J/K/L=672-711"}},{"databaseType":"PDB","id":"2LMO","properties":{"Method":"NMR","Resolution":"-","Chains":"A/B/C/D/E/F/G/H/I/J/K/L=672-711"}}]')},172:function(t,e,r){"use strict";r.r(e);var n=r(0),i=r.n(n),o=r(629),a=r(1099),s=(r(1051),r(1098)),u=r(1001),c=r(991),l=r(879),h=r(669),f=r(575),p=r(730),d=r(597),b=r(581),y=r(576),g=r(573),m=r(651),v=r(580),w=r(824),_=r(647),A=r(835),S=r(617),k=r(972),E=r(587),R=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},O=function(t){return!!t&&f.d.isFromPdbArchive(t)},P={local_metric_values:{label_asym_id:v.a.Schema.str,label_comp_id:v.a.Schema.str,label_seq_id:v.a.Schema.int,metric_id:v.a.Schema.int,metric_value:v.a.Schema.float,model_id:v.a.Schema.int,ordinal_id:v.a.Schema.int}},M=function(t,e){var r=function(t,e){if(_.a.is(e.sourceData)&&e.sourceData.data.frame.categoryNames.includes(t)){var r=e.sourceData.data.frame.categories[t].getField("metric_value");if(r&&0!==r.rowCount)return{timestamp_utc:r.str(0)||Object(k.a)(new Date)}}}("ma_qa_metric_local",e);if(r)return{info:r,data:function(t,e){for(var r=new Map,n=e.label_asym_id,i=e.label_seq_id,o=e.metric_value,a=e._rowCount,s=[],u=0;u<a;u++){var c=o.value(u),l=t.atomicHierarchy.index.findResidue("1",n.value(u),i.value(u),""),h="Very low";c>50&&c<=70?h="Low":c>70&&c<=90?h="Medium":c>90&&(h="High"),r.set(l,[c,h]),Object(E.l)(s,h)}return{score:f.c.fromResidueMap(r),category:s}}(e,function(t){if(!_.a.is(t.sourceData))throw new Error("Data format must be mmCIF.");return{residues:Object(w.c)(P.local_metric_values,t.sourceData.data.frame.categories.ma_qa_metric_local)}}(e).residues)}};function C(t,e,r){return R(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=M(0,e),t.abrupt("return",{value:r});case 2:case"end":return t.stop()}}),t)})))}function T(t){if(!f.n.isAtomic(t.unit))return[-1,"No Score"];var e=B.get(t.unit.model).value;if(!e||!e.data)return[-1,"No Score"];var r=t.unit.residueIndex[t.element];return e.data.score.has(r)?e.data.score.get(r):[-1,"No Score"]}var x=[];var j={serverUrl:g.a.Text("",{description:"JSON API Server URL"})},B=A.a.createProvider({label:"AF Confidence Score",descriptor:Object(S.b)({name:"af_confidence_score"}),type:"static",defaultParams:j,getParams:function(t){return j},isApplicable:function(t){return O(t)},obtain:function(t,e,r){return R(void 0,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Object.assign(Object.assign({},g.a.getDefaultValues(j)),r),t.next=3,C(0,e);case 3:return n=t.sent,t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))}});var D={"No Score":b.a.fromRgb(170,170,170),"Very low":b.a.fromRgb(255,125,69),Low:b.a.fromRgb(255,219,19),Medium:b.a.fromRgb(101,203,243),High:b.a.fromRgb(0,83,214)},N={type:g.a.MappedStatic("score",{score:g.a.Group({}),category:g.a.Group({kind:g.a.Text()})})};var I={name:"af-confidence",label:"AF Confidence",category:"Validation",factory:function t(e,r){var n;if(e.structure&&!e.structure.isEmpty&&e.structure.models[0].customProperties.has(B.descriptor))if("score"===r.type.name)n=function(t){if(f.h.Location.is(t)){var e=T(t);return D[e[1]]}return D["No Score"]};else{var i=r.type.params.kind;n=function(t){if(f.h.Location.is(t)){var e=T(t);return e[1]===i?D[e[1]]:D["No Score"]}return D["No Score"]}}else n=function(){return D["No Score"]};return{factory:t,granularity:"group",color:n,props:r,description:"Assigns residue colors according to the AF Confidence score"}},getParams:function(t){var e=function(t){if(!t)return x;var e=B.get(t.models[0]).value;return e&&e.data?e.data.category:x}(t.structure);return 0===e.length?{type:g.a.MappedStatic("score",{score:g.a.Group({})})}:{type:g.a.MappedStatic("score",{score:g.a.Group({}),category:g.a.Group({kind:g.a.Select(e[0],g.a.arrayToOptions(e))},{isFlat:!0})})}},defaultValues:g.a.getDefaultValues(N),isApplicable:function(t){var e;return O(null===(e=t.structure)||void 0===e?void 0:e.models[0])},ensureCustomProperties:{attach:function(t,e){return e.structure?B.attach(t,e.structure.models[0],void 0,!0):Promise.resolve()},detach:function(t){return t.structure&&t.structure.models[0].customProperties.reference(B.descriptor,!1)}}};function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function U(t,e){return(U=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function H(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=X(t);if(e){var i=X(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return q(this,r)}}function q(t,e){return!e||"object"!==F(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var G=m.a.create({name:"af-confidence-prop",category:"custom-props",display:{name:"AlphaFold Confidence Score",description:"AlphaFold Confidence Score."},ctor:function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&U(t,e)}(o,t);var e,r,n,i=H(o);function o(){var t;return L(this,o),(t=i.apply(this,arguments)).provider=B,t.labelAfConfScore={label:function(e){if(t.params.showTooltip&&"element-loci"===e.kind&&0!==e.elements.length){var r=e.elements[0],n=r.unit;if(!n.model.customProperties.hasReference(B.descriptor))return;var i=T(f.h.Location.create(e.structure,n,n.elements[y.d.getAt(r.indices,0)]));return i&&i[0]>0?"Confidence score: ".concat(i[0]," <small>( ").concat(i[1]," )</small>"):""}}},t}return e=o,(r=[{key:"register",value:function(){this.ctx.customModelProperties.register(this.provider,this.params.autoAttach),this.ctx.managers.lociLabels.addProvider(this.labelAfConfScore),this.ctx.representation.structure.themes.colorThemeRegistry.add(I)}},{key:"update",value:function(t){var e=this.params.autoAttach!==t.autoAttach;return this.params.autoAttach=t.autoAttach,this.params.showTooltip=t.showTooltip,this.ctx.customModelProperties.setDefaultAutoAttach(this.provider.descriptor.name,this.params.autoAttach),e}},{key:"unregister",value:function(){this.ctx.customModelProperties.unregister(B.descriptor.name),this.ctx.managers.lociLabels.removeProvider(this.labelAfConfScore),this.ctx.representation.structure.themes.colorThemeRegistry.remove(I)}}])&&V(e.prototype,r),n&&V(e,n),o}(m.a.Handler),params:function(){return{autoAttach:g.a.Boolean(!1),showTooltip:g.a.Boolean(!0)}}});r(1069);function z(t){return function(t){if(Array.isArray(t))return W(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return W(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Z(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var J=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},Q=!1,$=!1,K="reactive",Y=!1,tt=1,et=!1,rt=!0,nt=!1,it="pdbe",ot=(h.a.Viewport.ShowControls.defaultValue,h.a.Viewport.ShowSettings.defaultValue,function(){function t(e,r,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var o=Object(u.a)(),a={actions:o.actions,behaviors:[].concat(z(o.behaviors),[c.b.Behavior(G,{autoAttach:!0,showTooltip:!0})]),layout:{initial:{isExpanded:Q,showControls:$,controlsDisplay:K}},config:[[h.a.General.DisableAntialiasing,Y],[h.a.General.PixelScale,tt],[h.a.General.EnableWboit,et],[h.a.Viewport.ShowExpand,rt],[h.a.Viewport.ShowSelectionMode,nt],[h.a.Download.DefaultPdbProvider,it],[h.a.Structure.DefaultRepresentationPresetParams,{theme:{globalName:"af-confidence",carbonByChainId:!1,focus:{name:"element-symbol",params:{carbonByChainId:!1}}}}]]},l="string"==typeof e?document.getElementById(e):e;if(!l)throw new Error("Could not get element with id '".concat(e,"'"));this.plugin=Object(s.a)(l,a),this.plugin.behaviors.interaction.click.subscribe((function(t){if(f.h.Loci.is(t.current.loci)){var e=f.h.Location.create();f.h.Loci.getFirstLocation(t.current.loci,e);var n=f.i.residue.label_seq_id(e),i=f.i.chain.auth_asym_id(e);r([{position:n,chain:i}])}})),this.plugin.behaviors.canvas3d.initialized.subscribe((function(t){t&&(d.a.Canvas3D.SetSettings(i.plugin,{settings:function(t){t.renderer.backgroundColor=Object(b.a)(16777215),n&&(t.trackball.bindings.scrollZoom.triggers[0].modifiers.control=!0)}}),n&&(i.plugin.canvas3dContext.input.noScroll=!1,l.addEventListener("wheel",(function(t){t.ctrlKey&&t.preventDefault()}),!1)))}))}var e,r,n;return e=t,(r=[{key:"clear",value:function(t){this.plugin.clear(),t&&this.showMessage("Loading",t)}},{key:"loadPdb",value:function(t,e){var r=this,n=l.DownloadStructure.createDefaultParams(this.plugin.state.data.root.obj,this.plugin),i=this.plugin.config.get(h.a.Download.DefaultPdbProvider);return this.plugin.runTask(this.plugin.state.data.applyAction(l.DownloadStructure,{source:{name:"pdb",params:{provider:{id:t,server:{name:i,params:l.PdbDownloadProvider[i].defaultValue}},options:Object.assign(Object.assign({},n.source.params.options),{representationParams:null==e?void 0:e.representationParams})}}})).then((function(){r.clearMessages()}))}},{key:"loadCifUrl",value:function(t,e){return J(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,i,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.plugin,t.next=3,r.builders.data.download({url:e,isBinary:!1},{state:{isGhost:!0}});case 3:return n=t.sent,t.next=6,r.builders.structure.parseTrajectory(n,"mmcif");case 6:return i=t.sent,t.abrupt("return",this.plugin.builders.structure.hierarchy.applyPreset(i,"all-models",{useDefaultIfSingleModel:!0}).then((function(){return o.clearMessages()})));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"highlight",value:function(t){var e,r,n=null===(r=null===(e=this.plugin.managers.structure.hierarchy.current.structures[0])||void 0===e?void 0:e.cell.obj)||void 0===r?void 0:r.data;if(n){var i=p.a.getStructureSelection((function(e){return e.struct.generator.atomGroups({"residue-test":e.core.logic.or(t.map((function(t){var r=t.start,n=t.end,i=t.chain;return e.core.logic.and([e.core.rel.inRange([e.struct.atomProperty.macromolecular.label_seq_id(),r,n]),e.core.rel.eq([e.struct.atomProperty.macromolecular.auth_asym_id(),i])])})))})}),n),o=f.k.toLociWithSourceUnits(i);this.plugin.managers.camera.focusLoci(o),this.plugin.managers.interactivity.lociSelects.selectOnly({loci:o})}}},{key:"clearHighlight",value:function(){this.plugin.managers.interactivity.lociSelects.deselectAll(),d.a.Camera.Reset(this.plugin,{})}},{key:"showMessage",value:function(t,e,r){this.clearMessages(),d.a.Toast.Show(this.plugin,{title:t,message:e,timeoutMs:r})}},{key:"clearMessages",value:function(){d.a.Toast.Hide(this.plugin)}},{key:"handleResize",value:function(){this.plugin.layout.events.updated.next()}}])&&Z(e.prototype,r),n&&Z(e,n),t}()),at=r(632);function st(t){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ut(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||ct(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(t,e){if(t){if("string"==typeof t)return lt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lt(t,e):void 0}}function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ht(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ft(t,e){return!e||"object"!==st(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function pt(t){var e="function"==typeof Map?new Map:void 0;return(pt=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return dt(t,arguments,gt(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),yt(n,t)})(t)}function dt(t,e,r){return(dt=bt()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&yt(i,r.prototype),i}).apply(null,arguments)}function bt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function yt(t,e){return(yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&yt(t,e)}(i,t);var e,r,n=(e=i,r=bt(),function(){var t,n=gt(e);if(r){var i=gt(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return ft(this,t)});function i(){return ht(this,i),n.apply(this,arguments)}return i}(pt(Error)),vt=function(t,e,r,n){if(!r)return[];if(!t||!e||Number.isNaN(t)||Number.isNaN(e))throw new mt("Invalid start, end coordinates");var i=Object.entries(Object(at.a)(r,(function(t){return t.chain_id}))).map((function(r){var i,o=ut(r,2),a=(o[0],null),s=null,u=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=ct(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(o[1]);try{for(u.s();!(i=u.n()).done;){var c=i.value;if(c.unp_end-c.unp_start!=c.end.residue_number-c.start.residue_number)throw new mt("Mismatch between protein sequence and structure residues");var l="UP_PDB"===n?c.unp_start:c.start.residue_number,h="UP_PDB"===n?c.unp_end:c.end.residue_number;t>=l&&t<=h&&(a=c),e>=l&&e<=h&&(s=c)}}catch(t){u.e(t)}finally{u.f()}if(null===a||null===s)return null;var f="UP_PDB"===n?1:-1;return{entity:a.entity_id,chain:a.chain_id,start:t+f*(a.start.residue_number-a.unp_start),end:e+f*(s.start.residue_number-s.unp_start)}})).filter(Boolean);if(!i.length)throw new mt("Start or end coordinate outside of mapping range");return i};function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return At(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return At(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function St(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kt(t,e){return!e||"object"!==wt(e)&&"function"!=typeof e?Et(t):e}function Et(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Rt(t){var e="function"==typeof Map?new Map:void 0;return(Rt=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return Ot(t,arguments,Ct(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Mt(n,t)})(t)}function Ot(t,e,r){return(Ot=Pt()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&Mt(i,r.prototype),i}).apply(null,arguments)}function Pt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Tt=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},xt=function(t,e){var r=window.ga;r&&r("send","event","protvista-structure",t,e)},jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(c,t);var e,r,n,i,s,u=(e=c,r=Pt(),function(){var t,n=Ct(e);if(r){var i=Ct(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return kt(this,t)});function c(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this))._uniProtMappingUrl="https://www.ebi.ac.uk/pdbe/api/mappings/uniprot/",t._alphaFoldMappingUrl="https://alphafold.ebi.ac.uk/api/prediction/",t._planHighlight=t._planHighlight.bind(Et(t)),t.propagateHighlight=t.propagateHighlight.bind(Et(t)),t}return n=c,s=[{key:"is",get:function(){return"protvista-structure"}},{key:"observedAttributes",get:function(){return["highlight","structureid","accession","height"]}},{key:"_parseHighlight",value:function(t){return t?t.split(",").map((function(t){var e=_t(t.split(":"),2),r=e[0],n=e[1];return{start:Number(r),end:Number(n)}})):[]}}],(i=[{key:"css",get:function(){return"\n    protvista-structure h4 {\n      display: inline;\n      margin-right: 1em;\n    }\n      \n    .structure-viewer-container {\n      position: relative;\n      height: ".concat(this._height,";\n    }\n    ")}},{key:"accession",get:function(){return this._accession},set:function(t){this.setAttribute("accession",t)}},{key:"structureId",get:function(){return this._structureId},set:function(t){this.setAttribute("structureid",t),this._structureId=t}},{key:"height",get:function(){return this.getAttribute("height")},set:function(t){this.setAttribute("height",t),this._height=t}},{key:"updateUrls",value:function(){this._uniProtMappingUrl=this.getAttribute("uniprot-mapping-url")||this._uniProtMappingUrl,this._alphaFoldMappingUrl=this.getAttribute("alphafold-mapping-url")||this._alphaFoldMappingUrl,this._customDownloadUrl=this.getAttribute("custom-download-url")}},{key:"connectedCallback",value:function(){this.innerHTML="";var t=this.closest("protvista-manager");t&&"register"in t&&"unregister"in t&&(this.manager=t,this.manager.register(this)),this._structureId=this.getAttribute("structureid"),this._accession=this.getAttribute("accession"),this._height=this.getAttribute("height")||"480px",this._highlight=this.getAttribute("highlight")&&c._parseHighlight(this.getAttribute("highlight")),this.updateUrls();var e=document.createElement("style");e.innerHTML=this.css,this.appendChild(e);var r=document.createElement("div");r.className="structure-viewer-container",r.id="structure-viewer-instance",this.appendChild(r),this._structureViewer=new ot(r,this.propagateHighlight,this.hasAttribute("use-ctrl-to-zoom"))}},{key:"disconnectedCallback",value:function(){this.manager&&this.manager.unregister(this)}},{key:"attributeChangedCallback",value:function(t,e,r){if(e!==r){switch(t){case"structureid":null!==r&&(this._structureId=r),this.selectMolecule();break;case"accession":this._accession=r,this.selectMolecule();break;case"highlight":this._highlight=c._parseHighlight(this.getAttribute("highlight"));break;case"height":this._height=r}this._planHighlight()}}},{key:"_planHighlight",value:function(){var t=this;this._plannedRender||(this._plannedRender=!0,requestAnimationFrame((function(){t._plannedRender=!1,t._selectedMolecule&&t.highlightChain()})))}},{key:"loadPDBEntry",value:function(t){var e;return Tt(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return null===(e=this._structureViewer)||void 0===e||e.clear(t),r.prev=1,xt("load-PDBe",t),r.next=5,Object(o.b)("".concat(this._uniProtMappingUrl).concat(t));case 5:return n=r.sent,i=n.payload,r.abrupt("return",i);case 10:throw r.prev=10,r.t0=r.catch(1),this._structureViewer.showMessage("Error","Couldn't load PDB entry"),r.t0;case 14:case"end":return r.stop()}}),r,this,[[1,10]])})))}},{key:"loadAFEntry",value:function(t){var e;return Tt(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return null===(e=this._structureViewer)||void 0===e||e.clear(t),r.prev=1,r.next=4,Object(o.b)("".concat(this._alphaFoldMappingUrl).concat(t));case 4:return n=r.sent,i=n.payload,xt("load-AF",t),r.abrupt("return",i);case 10:throw r.prev=10,r.t0=r.catch(1),this._structureViewer.showMessage("Error","Couldn't load AF entry"),r.t0;case 14:case"end":return r.stop()}}),r,this,[[1,10]])})))}},{key:"isAF",value:function(){return this._structureId.startsWith("AF-")}},{key:"selectMolecule",value:function(){var t;return Tt(this,void 0,void 0,regeneratorRuntime.mark((function e(){var r,n,i,o,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._structureId&&this._accession){e.next=2;break}return e.abrupt("return");case 2:if(this.updateUrls(),!this.isAF()){e.next=12;break}return e.next=6,this.loadAFEntry(this._accession);case 6:return n=e.sent,i=n.find((function(t){return t.entryId===a._structureId})),e.next=10,this._structureViewer.loadCifUrl(this._structureId,i.cifUrl);case 10:e.next=23;break;case 12:return e.next=14,this.loadPDBEntry(this._structureId);case 14:if(o=e.sent,r=null===(t=Object.values(o)[0].UniProt[this._accession])||void 0===t?void 0:t.mappings,!this._customDownloadUrl){e.next=21;break}return e.next=19,this._structureViewer.loadCifUrl(this._structureId,"".concat(this._customDownloadUrl).concat(this._structureId.toLowerCase(),".cif"));case 19:e.next=23;break;case 21:return e.next=23,this._structureViewer.loadPdb(this._structureId.toLowerCase());case 23:this._selectedMolecule={id:this._structureId,mappings:r},this._planHighlight();case 25:case"end":return e.stop()}}),e,this)})))}},{key:"propagateHighlight",value:function(t){var e=this;if((null==t?void 0:t.length)&&!t.some((function(t){return!Number.isInteger(t.position)}))){var r;try{r=Object(a.a)(t,(function(t){return vt(t.position,t.position,e._selectedMolecule.mappings,"PDB_UP").filter((function(e){return e.chain===t.chain}))})).filter(Boolean)}catch(t){if(t instanceof mt)return void this._structureViewer.showMessage("Error",t.message);throw t}if(r.length){var n=r.map((function(t){return"".concat(t.start,":").concat(t.end)}));this.setAttribute("highlight",n.join(","));var i=new CustomEvent("change",{detail:{highlight:n},bubbles:!0,cancelable:!0});this.dispatchEvent(i)}else this._structureViewer.showMessage("Error","Residue outside of sequence range")}}},{key:"highlightChain",value:function(){var t=this;if(this._highlight&&"string"!=typeof this._highlight){var e;try{e=Object(a.a)(this._highlight,(function(e){var r=e.start,n=e.end;return t.isAF()?{start:r,end:n,chain:"A"}:vt(r,n,t._selectedMolecule.mappings,"UP_PDB")})).filter(Boolean)}catch(t){if(t instanceof mt)return this._structureViewer.clearHighlight(),void this._structureViewer.showMessage("Error",t.message);throw t}(null==e?void 0:e.length)?(this._structureViewer.highlight(e),this._structureViewer.clearMessages()):this._structureViewer.clearHighlight()}}}])&&St(n.prototype,i),s&&St(n,s),c}(Rt(HTMLElement)),Bt=r(917),Dt=r(701),Nt=r(111),It=r(35),Ft=r(1071),Lt=r.n(Ft),Vt=r(1072);function Ut(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ht(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ht(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}Object(Nt.a)("protvista-structure",jt),Object(Nt.a)("protvista-datatable",Bt.a),Object(Nt.a)("protvista-manager",Dt.a);var qt=[{name:"PDBe",url:function(t){return"https://www.ebi.ac.uk/pdbe-srv/view/entry/".concat(t)}},{name:"RCSB PDB",url:function(t){return"https://www.rcsb.org/structure/".concat(t)}},{name:"PDBj",url:function(t){return"https://pdbj.org/mine/summary/".concat(t)}},{name:"PDBsum",url:function(t){return"https://www.ebi.ac.uk/pdbsum/".concat(t)}}];e.default=function(){var t=Ut(Object(n.useState)("1AAP"),2),e=t[0],r=t[1],o=Object(n.useMemo)((function(){return Vt.map((function(t){var e=t.id,r=t.properties;if(!r)return null;var n,i,o,a=r.Chains,s=r.Resolution,u=r.Method;if(a){var c=a.split("=");if(2===c.length){var l=Ut(c,2);n=l[0];var h=(i=l[1]).split("-");h&&2===h.length&&(o=Ut(h,1)[0])}}return{id:e,method:u,resolution:s&&"-"!==s?s:null,chain:n,positions:i,protvistaFeatureId:e,start:Number(o)}}))})),a=function(t){r(t.detail.selectedid)};return Object(n.useEffect)((function(){return document.addEventListener("change",a),function(){document.removeEventListener("change",a)}}),[]),i.a.createElement(n.Fragment,null,i.a.createElement(It.default,{content:Lt.a}),i.a.createElement("h2",null,"Examples"),i.a.createElement("h3",null,"Structure with protvista-datatable"),i.a.createElement("protvista-structure",{structureid:e,accession:"P05067",highlight:"290:300,310:340"}),i.a.createElement("protvista-datatable",{selectedId:e,noScrollToRow:!0,noDeselect:!0},i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"PDB entry"),i.a.createElement("th",null,"Method"),i.a.createElement("th",null,"Resolution"),i.a.createElement("th",null,"Chain"),i.a.createElement("th",null,"Positions"),i.a.createElement("th",null,"Links"))),i.a.createElement("tbody",null,o.map((function(t){var e;return i.a.createElement("tr",{key:t.id,"data-id":t.id},i.a.createElement("td",null,t.id),i.a.createElement("td",null,t.method),i.a.createElement("td",null,null===(e=t.resolution)||void 0===e?void 0:e.replace("A","â„«")),i.a.createElement("td",null,t.chain),i.a.createElement("td",null,t.positions),i.a.createElement("td",null,qt.map((function(e){var r=e.name,n=e.url;return i.a.createElement("a",{href:n(t.id),key:r},r)}))))}))))),i.a.createElement("h3",null,"Custom PDB source URLs"),i.a.createElement("protvista-structure",{structureid:"5ELI",accession:"Q9NZC2","uniprot-mapping-url":"https://www.ebi.ac.uk/pdbe/api/mappings/uniprot/","custom-download-url":"https://files.rcsb.org/download/"}),i.a.createElement("h3",null,"Custom AlphaFold source URLs"),i.a.createElement("protvista-structure",{structureid:"AF-Q9NZC2-F1",accession:"Q9NZC2","alphafold-mapping-url":"https://alphafold.ebi.ac.uk/api/prediction/"}),i.a.createElement("h3",null,"Highlight, mapping with gaps"),i.a.createElement("protvista-structure",{structureid:"102L",accession:"P00720",highlight:"37:42","uniprot-mapping-url":"https://www.ebi.ac.uk/pdbe/api/mappings/uniprot/","custom-download-url":"https://files.rcsb.org/download/"}),i.a.createElement("h3",null,"Zoom using ctrl key + scroll (avoids interruptions when scrolling page)"),i.a.createElement("protvista-structure",{structureid:"5ELI",accession:"Q9NZC2","use-ctrl-to-zoom":!0}))}},593:function(t,e,r){"use strict";function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.d(e,"b",(function(){return T})),r.d(e,"e",(function(){return x})),r.d(e,"a",(function(){return j})),r.d(e,"d",(function(){return B})),r.d(e,"c",(function(){return D})),r.d(e,"f",(function(){return N}));var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.min,n=void 0===r?-1/0:r,i=e.max,a=void 0===i?1/0:i;o(this,t),this.segments=[],this.max=a,this.min=n,this.regionString=null}var e,r,i;return e=t,(r=[{key:"encode",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.segments.map((function(r){var n=r.start,i=r.end,o=r.color;if(e)return"".concat(n,":").concat(i).concat(o?":".concat(o):"");var a=n===t.min?"":n,s=i===t.max?"":i;return"".concat(a,":").concat(s).concat(o?":".concat(o):"")})).join(",")}},{key:"decode",value:function(t){var e=this;void 0!==t&&(this.regionString=t),this.regionString?this.segments=this.regionString.split(",").map((function(t){var r=n(t.split(":"),4),i=r[0],o=r[1],a=r[2];if(void 0!==r[3])throw new Error("there should be at most 2 ':' per region. Region: ".concat(t));var s=i?Number(i):e.min,u=o?Number(o):e.max,c=""!==a?a:void 0;if(s>u){var l=[u,s];s=l[0],u=l[1]}if(s<e.min&&(s=e.min),u>e.max&&(u=e.max),Number.isNaN(s))throw new Error("The parsed value of ".concat(i," is NaN. Region: ").concat(t));if(Number.isNaN(u))throw new Error("The parsed value of ".concat(o," is NaN. Region: ").concat(t));if(c&&!c.match(/^#[0-9a-f]{6,8}$/i))throw new Error("The parsed value of ".concat(a," is not a color in hex format. Region: ").concat(t));return{start:s,end:u,color:c}})):this.segments=[]}}])&&a(e.prototype,r),i&&a(e,i),t}();function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(t,e){return t?e?"".concat(t,",").concat(e):t:e},l=function(){function t(e){var r=e.element,n=e.min,i=e.max;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=r,this.element._highlightcolor="#FFEB3B66",this.region=new s({min:n,max:i}),this.fixedHighlight=null}var e,r,n;return e=t,(r=[{key:"max",set:function(t){this.region.max=t}},{key:"setAttributesInElement",value:function(){this.region.decode(this.element.getAttribute("highlight")),0===this.region.segments.length&&(this.element._highlightstart=Number(this.element.getAttribute("highlightstart")),this.element._highlightend=Number(this.element.getAttribute("highlightend")),this.element._highlightcolor=this.element.getAttribute("highlightcolor")||"#FFEB3B66",null!==this.element._highlightstart&&null!==this.element._highlightend&&"number"==typeof this.element._highlightstart&&"number"==typeof this.element._highlightend&&(this.element._highlight="".concat(this.element._highlightstart,":").concat(this.element._highlightend),this.region.decode(c(this.fixedHighlight,this.element._highlight))))}},{key:"setFloatAttribute",value:function(t,e){var r=parseFloat(e);this.element["_".concat(t)]=Number.isNaN(r)?e:r}},{key:"changedCallBack",value:function(t,e){switch(t){case"highlightstart":case"highlightend":this.setFloatAttribute(t,e),this.element._highlight=Number.isNaN(this.element._highlightstart)||Number.isNaN(this.element._highlightend)||void 0===this.element._highlightstart||void 0===this.element._highlightend||null===this.element._highlightstart||null===this.element._highlightend?"":"".concat(Math.max(this.region.min,this.element._highlightstart),":").concat(Math.min(this.region.max,this.element._highlightend));break;default:this.element._highlight=e}this.region.decode(c(this.fixedHighlight,this.element._highlight)),this.element.refresh()}},{key:"setFixedHighlight",value:function(t){this.fixedHighlight=t,this.region.decode(c(t,this.element._highlight)),this.element.refresh()}},{key:"appendHighlightTo",value:function(t){this.highlighted=t.append("g").attr("class","highlighted")}},{key:"updateHighlight",value:function(){var t=this,e=this.highlighted.selectAll("rect").data(this.region.segments);e.enter().append("rect").style("pointer-events","none").merge(e).attr("fill",(function(e){return e.color?e.color:t.element._highlightcolor})).attr("height",this.element._height).attr("x",(function(e){return t.element.getXFromSeqPosition(e.start)})).attr("width",(function(e){return t.element.getSingleBaseWidth()*(e.end-e.start+1)})),e.exit().remove()}}])&&u(e.prototype,r),n&&u(e,n),t}();function h(t){var e=document.createElement("div");return e.style.borderColor="",e.style.borderColor=t,""!==e.style.borderColor}var f=function(t){return t};function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.timeStampWheelOutside=0,this.resetScrollableTimeout=null}var e,r,n;return e=t,(r=[{key:"setElementScrollable",value:function(t){this.element.setAttribute("scrollable",t)}},{key:"startResetScrollableTimer",value:function(){var t=this;this.resetScrollableTimeout&&clearTimeout(this.resetScrollableTimeout),this.resetScrollableTimeout=setTimeout((function(){t.setElementScrollable(!0),t.resetScrollableTimeout=null}),400)}},{key:"blockScroll",value:function(t){this.timeStampWheelOutside=t,this.setElementScrollable(!1),this.startResetScrollableTimer()}},{key:"isWheelEventInsideElement",value:function(t,e){var r=this.element.getBoundingClientRect(),n=r.height,i=r.width,o=r.x,a=r.y;return t>o&&e<o+i&&e>a&&e<a+n}},{key:"wheel",value:function(t){var e=t.x,r=t.y,n=t.timeStamp;this.isWheelEventInsideElement(e,r)?n<this.timeStampWheelOutside+400?this.blockScroll(n):this.setElementScrollable(!0):this.blockScroll(n)}}])&&p(e.prototype,r),n&&p(e,n),t}();function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=m(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function g(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||m(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){if(t){if("string"==typeof t)return v(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(t,e):void 0}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function A(t,e,r){return e&&_(t.prototype,e),r&&_(t,r),t}function S(t,e,r){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=P(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function k(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=P(t);if(e){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return O(this,r)}}function O(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var M=["left","right","top","bottom"],C=M.map((function(t){return"margin".concat(t)})),T=s,x=l,j=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=[],r=[];if(null!==t&&"string"!=typeof t)throw new Error("The attribute text has to be of type string");if(t&&""!==t.trim()){var n=t.split(",").map((function(t){return t.split(":")}));if(n.length<2)throw new Error("There should be at least 2 points to create a scale");e=n.map((function(t){var e=t[0].trim().toUpperCase();if(!h(e))throw new Error("The color '".concat(e," is not valid'"));return e})),r=n.map((function(t,e){var r=parseFloat(t[1]);if(Number.isNaN(r))throw new Error("The second part of every point should be a number. Error in point ".concat(e,": ").concat(t));return r}))}return{range:e,domain:r}},B=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.keyFormatter,n=void 0===r?f:r,i=e.valueFormatter,o=void 0===i?f:i;if(null!==t&&"string"!=typeof t)throw new Error("The attribute text has to be of type string");if(t&&""!==t.trim()){var a=t.split(",").map((function(t){return t.split(":")})),s={};return a.forEach((function(t){if(2!==t.length)throw new Error("Bad block: ".concat(t.join(":"),"\n The blocks of the string should follow the format KEY:VALUE"));s[n(t[0])]=o(t[1])})),s}return{}},D=d,N=function(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{initialValue:{top:0,bottom:0,left:0,right:0}},n=function(t){k(n,t);var e=R(n);function n(){var t;return w(this,n),(t=e.call(this)).margin=r.initialValue,t}return A(n,[{key:"attributeChangedCallback",value:function(t,e,r){e!==r&&C.includes(t)&&(this[t]=r),S(P(n.prototype),"attributeChangedCallback",this).call(this,t,e,r)}}],[{key:"observedAttributes",get:function(){return[].concat(g(S(P(n),"observedAttributes",this)),g(C))}}]),n}(t),i=y(M);try{var o=function(){var t=e.value;Object.defineProperty(n.prototype,"margin".concat(t),{get:function(){return this.margin[t]||0},set:function(e){this.margin[t]=+e}})};for(i.s();!(e=i.n()).done;)o()}catch(t){i.e(t)}finally{i.f()}return n}},629:function(t,e,r){"use strict";r.d(e,"b",(function(){return g}));var n=r(675);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){var e="function"==typeof Map?new Map:void 0;return(c=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return l(t,arguments,p(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,t)})(t)}function l(t,e,r){return(l=h()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&f(i,r.prototype),i}).apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var b=function(t,e,r,n){return new(r||(r=Promise))((function(i,o){function a(t){try{u(n.next(t))}catch(t){o(t)}}function s(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},y=new Map,g=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Headers({accept:"application/json"}),r=y.get(t);if(r)return r;var n=b(void 0,void 0,void 0,regeneratorRuntime.mark((function r(){var n,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,window.fetch(t,{headers:e});case 2:if((n=r.sent).ok){r.next=5;break}throw new Error("Request Failed: Status = ".concat(n.status,"; URI = ").concat(t,"; Time = ").concat(new Date));case 5:if(204!==n.status){r.next=7;break}return r.abrupt("return",{payload:null,headers:n.headers});case 7:return r.next=9,n.json();case 9:return i=r.sent,r.abrupt("return",{payload:i,headers:n.headers});case 11:case"end":return r.stop()}}),r)})));return y.set(t,n),n.catch((function(){return y.delete(t)})),n},m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(y,t);var e,r,i,a,c,l=(e=y,r=h(),function(){var t,n=p(e);if(r){var i=p(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return u(this,t)});function y(){var t;return d(this,y),(t=l.call(this))._data=null,t.selector=(t.getAttribute("selector")||"").trim()||function(t){return t},t}return i=y,c=[{key:"is",get:function(){return"data-loader"}}],(a=[{key:"fetch",value:function(){return b(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,r,i,a,s,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=this.children,(e=Array.from(c).filter((function(t){return t.matches('source[src], script[type="application/json"]')}))).length){t.next=3;break}return t.abrupt("return");case 3:r=[],a=o(e),t.prev=5,a.s();case 7:if((s=a.n()).done){t.next=31;break}if(u=s.value,t.prev=9,!(u instanceof HTMLSourceElement)){t.next=22;break}return t.t0=Object,t.t1=Object,t.t2={},t.next=16,g(u.src);case 16:t.t3=t.sent,t.t4=t.t1.assign.call(t.t1,t.t2,t.t3),t.t5={srcElement:u,src:u.src},i=t.t0.assign.call(t.t0,t.t4,t.t5),t.next=23;break;case 22:i={payload:JSON.parse(u.textContent)};case 23:return t.abrupt("break",31);case 26:t.prev=26,t.t6=t.catch(9),r.push(t.t6);case 29:t.next=7;break;case 31:t.next=36;break;case 33:t.prev=33,t.t7=t.catch(5),a.e(t.t7);case 36:return t.prev=36,a.f(),t.finish(36);case 39:if(i){t.next=43;break}this._errors=r;try{this.dispatchEvent(new CustomEvent("error",{detail:r,bubbles:!0,cancelable:!0}))}catch(t){console.error(t)}return t.abrupt("return");case 43:"string"==typeof this.selector?this._data=Object(n.a)(i.payload,this.selector):this._data=this.selector(i.payload),i.payload=this.data,this.dispatchEvent(new CustomEvent("load",{detail:i,bubbles:!0,cancelable:!0}));case 46:case"end":return t.stop()}var c}),t,this,[[5,33,36,39],[9,26]])})))}},{key:"data",get:function(){return this._data}},{key:"loaded",get:function(){return!!this.data}},{key:"errors",get:function(){return this._errors}},{key:"selector",get:function(){return this._selector},set:function(t){this._selector=t}},{key:"connectedCallback",value:function(){this.fetch()}}])&&s(i.prototype,a),c&&s(i,c),y}(c(HTMLElement));e.a=m},701:function(t,e,r){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function u(t){var e="function"==typeof Map?new Map:void 0;return(u=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return c(t,arguments,f(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,t)})(t)}function c(t,e,r){return(c=l()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var i=new(Function.bind.apply(t,n));return r&&h(i,r.prototype),i}).apply(null,arguments)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(p,t);var e,r,n,o,u,c=(e=p,r=l(),function(){var t,n=f(e);if(r){var i=f(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return s(this,t)});function p(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(t=c.call(this)).protvistaElements=new Set,t.attributeValues=new Map,t.propertyValues=new Map,t.mouseOver=!1,t}return n=p,u=[{key:"observedAttributes",get:function(){return["attributes","length","displaystart","displayend","highlight"]}}],(o=[{key:"length",get:function(){return this.attributeValues.get("length")},set:function(t){this.attributeValues.set("length",t)}},{key:"displaystart",get:function(){return this.attributeValues.get("displaystart")},set:function(t){this.attributeValues.set("displaystart",t)}},{key:"displayend",get:function(){return this.attributeValues.get("displayend")},set:function(t){this.attributeValues.set("displayend",t)}},{key:"highlight",get:function(){return this.attributeValues.get("highlight")},set:function(t){this.attributeValues.set("highlight",t)}},{key:"attributeChangedCallback",value:function(t,e,r){if(e!==r){if("attributes"===t){if(this._attributes=r.split(" "),-1!==this._attributes.indexOf("type"))throw new Error("'type' can't be used as a protvista attribute");if(-1!==this._attributes.indexOf("value"))throw new Error("'value' can't be used as a protvista attribute");this.attributeValues=new Map(this._attributes.filter((function(t){return!p.observedAttributes.includes(t)})).map((function(t){return[t,null]})))}else"length"===t&&(this.length=r),"displaystart"===t&&(this.displaystart=r),"displayend"===t&&(this.displayend=r),"highlight"===t&&(this.highlight=r);this.applyAttributes()}}},{key:"register",value:function(t){this.protvistaElements.add(t),this.applyAttributes()}},{key:"unregister",value:function(t){this.protvistaElements.delete(t)}},{key:"_polyfillElementClosest",value:function(){var t=this;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var r=t;do{if(r.matches(e))return r;r=r.parentElement||r.parentNode}while(null!==r&&1===r.nodeType);return null})}},{key:"applyAttributes",value:function(){var t=this;this.protvistaElements.forEach((function(e){t.attributeValues.forEach((function(t,r){!1===t||null==t?e.removeAttribute(r):e.setAttribute(r,"boolean"==typeof t?"":t)}))}))}},{key:"applyProperties",value:function(t){var e=this;if(t){var r=this.querySelector("#".concat(t));this.propertyValues.forEach((function(t,e){r[e]=t}))}else this.protvistaElements.forEach((function(t){e.propertyValues.forEach((function(e,r){t[r]=e}))}))}},{key:"isRegisteredAttribute",value:function(t){return i(this.attributeValues.keys()).includes(t)||p.observedAttributes.includes(t)}},{key:"_changeListener",value:function(t){var e=this;if(t.detail)switch(t.detail.handler){case"property":this.propertyValues.set(t.detail.type,t.detail.value),this.applyProperties(t.detail.for);break;default:this.isRegisteredAttribute(t.detail.type)&&this.attributeValues.set(t.detail.type,t.detail.value),Object.keys(t.detail).forEach((function(r){e.isRegisteredAttribute(r)&&e.attributeValues.set(r,t.detail[r])})),this.applyAttributes()}}},{key:"connectedCallback",value:function(){this.addEventListener("change",this._changeListener)}}])&&a(n.prototype,o),u&&a(n,u),p}(u(HTMLElement));e.a=p},917:function(t,e,r){"use strict";var n,i,o,a,s,u,c=r(63),l=r(593);function h(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var f,p,d=Object(c.b)(n||(n=h(["pd-group-trigger__expanded"]))),b=Object(c.b)(i||(i=h(["active"]))),y=Object(c.b)(o||(o=h(["transparent"]))),g=Object(c.b)(a||(a=h(["overlapped"]))),m=Object(c.b)(s||(s=h(["hidden"]))),v=Object(c.b)(u||(u=h(["\n  protvista-datatable table {\n    width: 100%;\n    padding: 0;\n    margin: 0;\n    border-spacing: 0;\n  }\n\n  protvista-datatable table th {\n    position: sticky;\n    position: -webkit-sticky;\n    position: -moz-sticky;\n    position: -ms-sticky;\n    position: -o-sticky;\n    text-align: left;\n    vertical-align: top;\n    background-color: var(--protvista-datable__header-background, #fff);\n    color: var(--protvista-datable__header-text, #393b42);\n    text-overflow: ellipsis;\n    top: 0;\n    text-transform: uppercase;\n    z-index: 400;\n  }\n\n  protvista-datatable table th .filter-wrap {\n    display: flex;\n    flex-direction: column;\n  }\n\n  protvista-datatable table th .filter-wrap select {\n    width: fit-content;\n  }\n\n  protvista-datatable table td,\n  protvista-datatable table th {\n    padding: 0.2rem;\n    border-bottom: 1px solid #c2c4c4;\n  }\n\n  protvista-datatable table tr:hover:not(.","):not(.",') {\n    background-color: var(--protvista-datatable__hover, #f1f1f1);\n  }\n\n  protvista-datatable table td {\n    cursor: pointer;\n  }\n\n  protvista-datatable table .pd-group-trigger {\n    width: 1rem;\n  }\n\n  protvista-datatable table .pd-group-trigger button {\n    background: none;\n    border: none;\n    padding: 0.2rem; // increase click area\n    position: relative;\n    text-decoration: none;\n    cursor: pointer;\n    transition: background 250ms ease-in-out, transform 150ms ease;\n    -webkit-appearance: none;\n    -moz-appearance: none;\n  }\n\n  protvista-datatable table .pd-group-trigger button:before {\n    display: inline-block;\n    content: " ";\n    border-style: solid;\n    border-width: 0.4rem 0 0.4rem 0.6rem;\n    border-color: transparent transparent transparent #161d39;\n    transition-duration: 0.3s;\n    transition-property: transform;\n  }\n\n  protvista-datatable table .pd-group-trigger button.',":before {\n    transform: rotate(90deg);\n  }\n\n  protvista-datatable table td:nth-child(1) {\n    border-left: 0.5rem solid transparent;\n  }\n\n  protvista-datatable table ."," td:nth-child(1) {\n    border-left: 0.5rem solid\n      var(--protvista-datatable__overlapped, rgba(255, 0, 0, 0.8));\n  }\n\n  protvista-datatable table ."," {\n    background-color: var(\n      --protvista-datatable__active,\n      rgba(255, 235, 59, 0.3)\n    ) !important;\n  }\n\n  protvista-datatable table ."," {\n    opacity: 0.2;\n  }\n  protvista-datatable table ."," td:hover {\n    cursor: default;\n    background-color: inherit;\n  }\n\n  protvista-datatable table ."," {\n    display: none;\n  }\n\n  protvista-datatable table tr[data-group-for] td {\n    padding-left: 1.7rem;\n    padding-bottom: 0.7rem;\n  }\n\n  protvista-datatable table .odd {\n    background-color: var(--protvista-datatable__odd, #e4e8eb);\n  }\n\n  protvista-datatable table .even {\n    background-color: var(--protvista-datatable__even, #fff);\n  }\n"])),b,y,d,g,b,y,y,m);function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function A(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null==r)return;var n,i,o=[],a=!0,s=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(o.push(n.value),!e||o.length!==e);a=!0);}catch(t){s=!0,i=t}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}(t,e)||k(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t){return function(t){if(Array.isArray(t))return E(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||k(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){if(t){if("string"==typeof t)return E(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?E(t,e):void 0}}function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function O(t,e,r){return(O="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(n){var i=Object.getOwnPropertyDescriptor(n,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=x(t);if(e){var i=x(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return C(this,r)}}function C(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?T(t):e}function T(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(o,t);var e,r,n,i=M(o);function o(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).height="25rem",t.visibleChildren=[],t.noScrollToRow=!1,t.noDeselect=!1,t.expandTable=!1,t.scrollFilter=new l.c(T(t)),t.wheelListener=function(e){return t.scrollFilter.wheel(e)},t.eventHandler=t.eventHandler.bind(T(t)),t}return e=o,n=[{key:"is",get:function(){return"protvista-datatable"}},{key:"properties",get:function(){return{highlight:{converter:function(t){if(t&&"null"!==t)try{var e=t.split(":").map((function(t){return Number(t)}));if(2!==e.length)throw new Error("Highlight should be only 2 values separated by ':'.");return[e[0],e[1]]}catch(t){console.error("Invalid highlight coordinates:",t)}return null}},height:{type:String},displayStart:{type:Number},displayEnd:{type:Number},visibleChildren:{type:Array},selectedid:{type:String},noScrollToRow:{type:Boolean},noDeselect:{type:Boolean},expandTable:{type:Boolean}}}},{key:"styles",get:function(){return Object(c.b)(p||(p=_(["\n      :host {\n        display: block;\n      }\n      .protvista-datatable-container {\n        overflow-y: auto;\n        // Note: overflow-x was set to 'hidden' but changing\n        // to 'auto' doesn't seem to be an issue.\n        overflow-x: auto;\n      }\n\n      :host([scrollable=\"true\"]) .protvista-datatable-container {\n        overflow-y: auto;\n        will-change: scroll;\n      }\n\n      :host([scrollable=\"false\"]) .protvista-datatable-container {\n        overflow-y: hidden;\n      }\n    "])))}}],(r=[{key:"connectedCallback",value:function(){var t=this;O(x(o.prototype),"connectedCallback",this).call(this);var e=this.querySelector("table tbody");if(e){this.mutationObserver=new MutationObserver((function(){t.init()})),this.mutationObserver.observe(e,{characterData:!0,childList:!0,subtree:!0});var r=document.createElement("style");r.innerHTML=v.toString(),document.querySelector("head").appendChild(r),this.closest("protvista-manager")&&(this.manager=this.closest("protvista-manager"),this.manager.register(this)),this.noDeselect||document.addEventListener("click",this.eventHandler),this.classList.add("feature"),this.hasAttribute("filter-scroll")&&document.addEventListener("wheel",this.wheelListener,{capture:!0}),this.init()}}},{key:"disconnectedCallback",value:function(){O(x(o.prototype),"disconnectedCallback",this).call(this),this.manager&&this.manager.unregister(this),document.removeEventListener("click",this.eventHandler),document.removeEventListener("wheel",this.wheelListener),this.mutationObserver.disconnect()}},{key:"init",value:function(){var t=this;if(this.columns=this.querySelectorAll("table thead th"),!this.querySelector(".pd-group-column-header")){var e=document.createElement("th");e.classList.add("pd-group-column-header");var r=this.querySelector("table thead tr");r.insertBefore(e,r.firstChild)}this.rows=this.querySelectorAll("table tbody tr"),this.rows.forEach((function(e){if(!e.dataset.groupFor&&!e.querySelector(".pd-group-trigger")){var r=e.insertCell(0);if(r.classList.add("pd-group-trigger"),t.querySelector("[data-group-for]")){var n=document.createElement("button");n.dataset.triggerId=e.dataset.id,r.appendChild(n),n.addEventListener("click",(function(e){return t.handleGroupToggle(e)}))}}e.addEventListener("click",(function(r){return t.handleClick(r,e)}))})),this.updateRowStyling(),this.selectedFilters=new Map,this.filterMap=this.parseDataForFilters(),this.addFilterOptions()}},{key:"parseDataForFilters",value:function(){var t,e,r=(t=this.columns,e=new Map,t.forEach((function(t){t.dataset.filter&&e.set(t.dataset.filter,new Set)})),e);return this.rows.forEach((function(t){t.childNodes.forEach((function(t){var e;(null===(e=t.dataset)||void 0===e?void 0:e.filter)&&r.get(t.dataset.filter).add(t.dataset.filterValue)}))})),r}},{key:"addFilterOptions",value:function(){var t=this;this.columns.forEach((function(e){var r,n;e.dataset.filter&&(e.querySelector(".filter-wrap")?(r=e.querySelector("select"),n=e.querySelector(".filter-wrap")):((n=document.createElement("span")).className="filter-wrap",n.innerHTML=e.innerHTML,(r=document.createElement("select")).dataset.testid="select",r.onchange=function(r){return t.handleFilterChange(r,e.dataset.filter)}),r.innerHTML="<option  selected value>-- Select --</option>",t.filterMap.get(e.dataset.filter).forEach((function(t){var e=document.createElement("option");e.value=t,e.label=t,e.dataset.testid="select-option",r.appendChild(e)})),e.innerHTML="",n.appendChild(r),e.appendChild(n))}))}},{key:"eventHandler",value:function(t){var e=t.target;e.closest("protvista-datatable")||e.closest(".feature")||(this.selectedid=null,this.highlight=null)}},{key:"handleGroupToggle",value:function(t){var e=t.target.dataset.triggerId;this.visibleChildren.includes(e)?(this.visibleChildren=this.visibleChildren.filter((function(t){return t!==e})),t.target.classList.remove(d.cssText)):(this.visibleChildren=[].concat(S(this.visibleChildren),[e]),t.target.classList.add(d.cssText))}},{key:"handleClick",value:function(t,e){if(!e.classList.contains("transparent")){var r=e.dataset,n=r.id,i=r.start,o=r.end;this.selectedid=n;var a={};i&&o&&(a.highlight="".concat(i,":").concat(o)),this.selectedid&&(a.selectedid=this.selectedid),this.dispatchEvent(new CustomEvent("change",{detail:a,bubbles:!0,cancelable:!0}))}}},{key:"handleFilterChange",value:function(t,e){var r=t.target.selectedOptions.item(0).value;r?this.selectedFilters.set(e,r):this.selectedFilters.delete(e),this.updateRowStyling()}},{key:"isRowVisible",value:function(t){var e=!t.dataset.groupFor||t.dataset.groupFor&&this.visibleChildren.includes(t.dataset.groupFor);if(!this.selectedFilters||0===this.selectedFilters.size)return e;var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=k(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}(this.selectedFilters);try{for(n.s();!(r=n.n()).done;){var i=A(r.value,2),o=i[0],a=i[1],s=void 0;if((s=t.dataset.groupFor?this.querySelector('[data-id="'.concat(t.dataset.groupFor,'"]')).querySelector('[data-filter="'.concat(o,'"]')):t.querySelector('[data-filter="'.concat(o,'"]')))&&s.dataset.filterValue!==a)return!1}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"updateRowStyling",value:function(){var t,e=this,r=0;null===(t=this.rows)||void 0===t||t.forEach((function(t){e.isRowVisible(t)?t.classList.remove(m.cssText):t.classList.add(m.cssText),t.dataset.groupFor||r++;var n=t.dataset,i=n.start,o=n.end;if(t.classList.add(r%2==0?"even":"odd"),!e.selectedid||e.selectedid!==t.dataset.id&&t.dataset.groupFor!==e.selectedid?t.classList.remove(b.cssText):t.classList.add(b.cssText),function(t,e,r,n){return t>n||e<r}(e.displayStart,e.displayEnd,Number(i),Number(o))?t.classList.add(y.cssText):t.classList.remove(y.cssText),e.highlight&&function(t,e,r,n){return!r&&e===n||!n&&t===r||t<=r&&e>=n}(e.highlight[0],e.highlight[1],Number(i),Number(o))?t.classList.add(g.cssText):t.classList.remove(g.cssText),t.dataset.groupFor){var a=e.columns.length+1;t.cells[0].colSpan=a-t.cells.length+1}}))}},{key:"scrollIntoView",value:function(){if(this.selectedid){var t=this.querySelector('[data-id="'.concat(this.selectedid,'"]'));null==t||t.scrollIntoView({behavior:"smooth",block:"center"})}}},{key:"render",value:function(){var t=this.expandTable||this.hasAttribute("expand-table")?"height: auto":"max-height:".concat(this.height);return Object(c.c)(f||(f=_(['\n      <div class="protvista-datatable-container" style=',">\n        <slot></slot>\n      </div>\n    "])),t)}},{key:"updated",value:function(){this.updateRowStyling(),this.noScrollToRow||this.scrollIntoView()}}])&&R(e.prototype,r),n&&R(e,n),o}(c.a);e.a=j}}]);